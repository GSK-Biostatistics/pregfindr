<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pregfindr">
<title>pregfindr • pregfindr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="pregfindr">
<meta property="og:description" content="pregfindr">
<meta property="og:image" content="https://gsk-biostatistics.github.io/pregfindr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pregfindr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/pregfindr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/codelists.html">Codelists</a>
    <a class="dropdown-item" href="../articles/data_extraction.html">Data Extraction</a>
    <a class="dropdown-item" href="../articles/identifying_pregnancy_start_and_end_dates.html">Identifying Pregnancy Start and End Dates</a>
    <a class="dropdown-item" href="../articles/outcome_hierarchy.html">Outcome Hierarchy</a>
    <a class="dropdown-item" href="../articles/trimester_hierarchy.html">Trimester Hierarchy</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>pregfindr</h1>
            
      
      
      <div class="d-none name"><code>pregfindr.Rmd</code></div>
    </div>

    
    
<p>This package allows you to identify pregnancies in a specific cut of
the IBM MarketScan database using the algorithm described in Sumner, K.
M., Ehlinger, A., Georgiou, M. E., &amp; Wurst, K. E. (2021).
Development and evaluation of standardized pregnancy identification and
trimester distribution algorithms in U.S. IBM MarketScan® Commercial and
Medicaid data. Birth defects research, 113(19), 1357–1367. <a href="https://doi.org/10.1002/bdr2.1954" class="external-link uri">https://doi.org/10.1002/bdr2.1954</a></p>
<p>Identifying the pregnancies using the package requires the following
steps:<br>
1. Extracting specific records between specific dates from the desired
cut of MarketScan<br>
2. Assigning a single trimester code for records with the same service
day<br>
3. Assigning a single outcome for records with the same service
day<br>
4. Assigning pregnancy start and end date for each pregnancy</p>
<p>The algorithm we implemented relies on specific code lists drafted by
GSK professionals. These are used internally by the package. To learn
more about the codelists and how to modify them, refer to the <a href="codelists.html">codelist vignette</a>.</p>
<p>Note: due to the large volume of data and the amount of computational
power required to run this algorithm, you should avoid running your
scripts locally and instead run them as a job on a powerful server.
Thankfully, you only have to run the following steps once per MarketScan
cut.</p>
<div class="section level2">
<h2 id="extraction-of-records">1. Extraction of records<a class="anchor" aria-label="anchor" href="#extraction-of-records"></a>
</h2>
<p>The first step is the extraction of specific claims records (marked
by the codes stored in the codelists) for services between specific
dates on women within specific age boundaries.</p>
<p>Different companies use different technologies to store the latest
cut of MarketScan. For this reason, we are providing an example script
that can be used as a guideline. Refer to the <a href="data_extraction.html">data extraction vignette</a>.</p>
<p>You should adapt the data extraction step to work with your storage
system.</p>
<p>Note: For the successful execution of the code, the record sample
size must be sufficiently large. If any errors occur, they are likely
due to an inadequate sample size. In such cases, consider expanding the
age range of interest.</p>
</div>
<div class="section level2">
<h2 id="apply-trimester-hierarchy">2. Apply trimester hierarchy<a class="anchor" aria-label="anchor" href="#apply-trimester-hierarchy"></a>
</h2>
<p>Once you are done with the first step, you should have a subset of
MarketScan. The outcome should have records for many patients and follow
this format.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="fu">pregfindr</span><span class="fu">::</span><span class="va"><a href="../reference/extraction_example.html">extraction_example</a></span></span></code></pre></div>
<p>You can apply the trimester hierarchy to these data to reassign the
trimester codes for claims that have different trimester codes on the
same service day. We recommend that you store the result to disk.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gsk-biostatistics.github.io/pregfindr/">pregfindr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load data extraction results</span></span>
<span><span class="va">extraction_result</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="st">"extraction_result5060.parquet"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Store file locally (TRUE / FALSE)</span></span>
<span><span class="va">trimester_hierarchy_save_locally</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">trimester_hierarchy_filepath</span> <span class="op">&lt;-</span> <span class="st">"commercial_trimester_hierarchy_final.parquet"</span></span>
<span></span>
<span><span class="co"># Apply trimester hierarchy</span></span>
<span><span class="va">trimester_hierarchy_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_trimester_hierarchy.html">apply_trimester_hierarchy</a></span><span class="op">(</span><span class="va">extraction_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Saving results Locally -------</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">trimester_hierarchy_save_locally</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/write_parquet.html" class="external-link">write_parquet</a></span><span class="op">(</span><span class="va">trimester_hierarchy_final</span>, <span class="va">trimester_hierarchy_filepath</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To learn more about the trimester reallocation hierarchy, we
encourage you to check the <a href="trimester_hierarchy.html">Trimester
Hierarchy vignette</a> and to read the function documentation and its
utilities:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="fu">pregfindr</span><span class="fu">::</span><span class="fu"><a href="../reference/apply_trimester_hierarchy.html">apply_trimester_hierarchy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="apply-outcome-hierarchy">3. Apply outcome hierarchy<a class="anchor" aria-label="anchor" href="#apply-outcome-hierarchy"></a>
</h2>
<p>You should then apply the outcome hierarchy to reassign pregnancy
outcomes for outcomes on the same service day.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Store file locally (TRUE / FALSE)</span></span>
<span><span class="va">outcome_hierarchy_save_locally</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">outcome_hierarchy_filepath</span> <span class="op">&lt;-</span> <span class="st">"commercial_outcome_hierarchy_final.parquet"</span></span>
<span></span>
<span><span class="co"># Apply outcome hierarchy</span></span>
<span><span class="va">outcome_hierarchy_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_outcome_hierarchy.html">apply_outcome_hierarchy</a></span><span class="op">(</span><span class="va">trimester_hierarchy_final</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Saving results Locally -------</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">outcome_hierarchy_save_locally</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/write_parquet.html" class="external-link">write_parquet</a></span><span class="op">(</span><span class="va">outcome_hierarchy_final</span>, <span class="va">outcome_hierarchy_filepath</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To learn more about the outcome reallocation hierarchy, we encourage
you to check the <a href="outcome_hierarchy.html">Outcome Hierarchy
vignette</a> and to read the function documentation and its
utilities:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="fu">pregfindr</span><span class="fu">::</span><span class="fu"><a href="../reference/apply_outcome_hierarchy.html">apply_outcome_hierarchy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimate-pregnancy-start-and-end-date">4. Estimate pregnancy start and end date<a class="anchor" aria-label="anchor" href="#estimate-pregnancy-start-and-end-date"></a>
</h2>
<p>You should then assign the start and end dates of a pregnancy.<br>
If patients have multiple outcomes, gestation weeks codes or multiple
trimester codes, overlapping start and end dates can result. This step
applies hierarchies to assign start and end dates to each pregnancy
episode for each patient.</p>
<p>Due to the large number of calculations, this step is really
slow.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Store file locally (TRUE / FALSE)</span></span>
<span><span class="va">outcome_start_end_date_save_locally</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">pregnancy_data_cleaned_filepath</span> <span class="op">&lt;-</span> <span class="st">"pregnancy_data_cleaned.parquet"</span></span>
<span></span>
<span><span class="co"># Apply pregnancy start and end date hierarchy</span></span>
<span><span class="va">pregnancy_data_cleaned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_pregnancy_start_end_hierarchy.html">apply_pregnancy_start_end_hierarchy</a></span><span class="op">(</span><span class="va">outcome_hierarchy_final</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Saving results Locally -------</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">outcome_start_end_date_save_locally</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/write_parquet.html" class="external-link">write_parquet</a></span><span class="op">(</span><span class="va">pregnancy_data_cleaned</span>, <span class="va">pregnancy_data_cleaned_filepath</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To learn more about the pregnancy start and end allocation hierarchy,
we encourage you to check the <a href="identifying_pregnancy_start_and_end_dates.html">Identifying
Pregnancy Start and End Dates vignette</a> and to read the function
documentation and its utilities:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="fu">pregfindr</span><span class="fu">::</span><span class="fu"><a href="../reference/apply_pregnancy_start_end_hierarchy.html">apply_pregnancy_start_end_hierarchy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Federico Concas, Jaspreet Multani, GlaxoSmithKline Research &amp; Development Limited.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
